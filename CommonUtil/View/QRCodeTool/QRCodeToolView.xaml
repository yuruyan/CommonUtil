<Page
  x:Class="CommonUtil.View.QRCodeToolView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:colorpicker="clr-namespace:ColorPicker;assembly=ColorPicker"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:CommonUtil.View"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:system="clr-namespace:System;assembly=mscorlib"
  xmlns:ui="http://schemas.modernwpf.com/2019"
  xmlns:widget="clr-namespace:CommonUITools.Widget;assembly=CommonUITools"
  Title="QRCodeToolView"
  Margin="8,0,0,0"
  d:DesignHeight="450"
  d:DesignWidth="800"
  DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}"
  mc:Ignorable="d">
  <Page.Resources>
    <system:Double x:Key="TopNavigationViewOverflowButtonWidth">100</system:Double>
    <Style TargetType="ui:FontIcon">
      <Setter Property="FontFamily" Value="{StaticResource IconFontUrI}" />
    </Style>
    <Style TargetType="ui:NavigationViewItem">
      <Setter Property="ToolTipService.InitialShowDelay" Value="{StaticResource ToolTipServiceInitialShowDelay}" />
    </Style>
    <!--  Resources for NavigationView  -->
    <SolidColorBrush x:Key="NavigationViewExpandedPaneBackground" Color="Transparent" />
    <SolidColorBrush x:Key="NavigationViewTopPaneBackground" Color="Transparent" />
    <SolidColorBrush x:Key="NavigationViewDefaultPaneBackground" Color="Transparent" />
  </Page.Resources>
  <UniformGrid Columns="2">
    <ui:NavigationView
      x:Name="NavigationView"
      IsBackButtonVisible="Collapsed"
      IsPaneToggleButtonVisible="False"
      IsSettingsVisible="False"
      IsTabStop="False"
      OpenPaneLength="40"
      PaneDisplayMode="Left"
      SelectionChanged="NavigationViewSelectionChanged">
      <ui:NavigationView.MenuItems>
        <ui:NavigationViewItem
          Name="URLQRCodeView"
          Content="链接二维码"
          IsSelected="True"
          ToolTip="链接二维码">
          <ui:NavigationViewItem.Icon>
            <ui:FontIcon Foreground="#30A4C5" Glyph="&#xe6ca;" />
          </ui:NavigationViewItem.Icon>
        </ui:NavigationViewItem>
        <ui:NavigationViewItem
          Name="SMSQRCodeView"
          Content="短信二维码"
          ToolTip="短信二维码">
          <ui:NavigationViewItem.Icon>
            <ui:FontIcon Foreground="#20AC95" Glyph="&#xe61a;" />
          </ui:NavigationViewItem.Icon>
        </ui:NavigationViewItem>
        <ui:NavigationViewItem
          Name="WIFIQRCodeView"
          Content="WiFi 二维码"
          ToolTip="WiFi 二维码">
          <ui:NavigationViewItem.Icon>
            <ui:FontIcon Foreground="#19A3E0" Glyph="&#xe65f;" />
          </ui:NavigationViewItem.Icon>
        </ui:NavigationViewItem>
        <ui:NavigationViewItem
          Name="MailQRCodeView"
          Content="邮件二维码"
          ToolTip="邮件二维码">
          <ui:NavigationViewItem.Icon>
            <ui:FontIcon Foreground="#29AF86" Glyph="&#xe620;" />
          </ui:NavigationViewItem.Icon>
        </ui:NavigationViewItem>
        <ui:NavigationViewItem
          Name="PhoneNumberQRCodeView"
          Content="拨打电话二维码"
          ToolTip="拨打电话二维码">
          <ui:NavigationViewItem.Icon>
            <ui:FontIcon Foreground="#2FAFCE" Glyph="&#xe67d;" />
          </ui:NavigationViewItem.Icon>
        </ui:NavigationViewItem>
        <ui:NavigationViewItem
          Name="GeolocationQRCodeView"
          Content="地理位置二维码"
          ToolTip="地理位置二维码">
          <ui:NavigationViewItem.Icon>
            <ui:FontIcon Foreground="#C25E2D" Glyph="&#xe76f;" />
          </ui:NavigationViewItem.Icon>
        </ui:NavigationViewItem>
      </ui:NavigationView.MenuItems>
      <ui:SimpleStackPanel Margin="8,0,0,0" Spacing="16">
        <ui:Frame x:Name="ContentFrame" Margin="0,8,0,0" />
        <!--  前景色选择  -->
        <ui:SimpleStackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock Width="{StaticResource QRCodeToolView_DescriptionWidth}" Text="二维码颜色：" />
          <Rectangle
            Width="100"
            Height="40"
            ContextMenuService.IsEnabled="True"
            Fill="{Binding QRCodeForeground, Converter={StaticResource ColorToBrushConverter}}"
            MouseUp="QRCodeForegroundRectangleMouseUp">
            <Rectangle.ContextMenu>
              <ContextMenu Width="240">
                <ContextMenu.Resources>
                  <SolidColorBrush x:Key="MenuFlyoutItemRevealBackgroundPointerOver" Color="Transparent" />
                  <SolidColorBrush x:Key="MenuFlyoutItemRevealBackgroundPressed" Color="Transparent" />
                </ContextMenu.Resources>
                <StackPanel Background="Transparent" MouseUp="QRCodeForegroundColorPickerPanelMouseUp">
                  <colorpicker:SquarePicker
                    x:Name="QRCodeForegroundColorPicker"
                    Width="200"
                    Height="200"
                    Loaded="QRCodeForegroundColorPickerLoadedHandler"
                    SelectedColor="{Binding QRCodeForeground, Mode=TwoWay}" />
                </StackPanel>
              </ContextMenu>
            </Rectangle.ContextMenu>
          </Rectangle>
          <TextBox
            Margin="8,0,0,0"
            KeyUp="QRCodeForegroundKeyUpHandler"
            Text="{Binding QRCodeForegroundText, UpdateSourceTrigger=PropertyChanged}" />
        </ui:SimpleStackPanel>
        <!--  Control  -->
        <ui:SimpleStackPanel Orientation="Horizontal" Spacing="16">
          <widget:IconButton
            Click="GenerateImageClick"
            Icon="&#xe601;"
            Text="生成" />
          <widget:IconButton
            Click="SaveImageClick"
            Icon="&#xe616;"
            Text="保存"
            Visibility="{Binding QRCodeImageSource, Converter={StaticResource HideIfNullConverter}}" />
        </ui:SimpleStackPanel>
      </ui:SimpleStackPanel>
    </ui:NavigationView>
    <Image Source="{Binding QRCodeImageSource}" Stretch="Uniform" />
  </UniformGrid>
</Page>
